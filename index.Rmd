---
title: " Ensino Superior - Raça/Cor: "
output: 
  flexdashboard::flex_dashboard:
 #   logo: figure/reconhecendosalvador.gif
    css: style.css
    theme: paper
    social: menu
    orientation: columns
    vertical_layout: fill
    source_code: embed
---



```{r setup, include=FALSE}
library(flexdashboard)
library(ggplot2)
library("readr")
library("dplyr")
library("tidyr")
library(ggthemes)
library(extrafont)
library(gganimate)


library(echarts4r) # charts
library(tidyverse) # general use
library(lubridate) # dates and times
library(prophet) # forecasting




CENSO_SUP <- NULL
CENSO_SUP <- read_delim("data/educacao/CENSO_SUPERIOR/DM_ALUNO_2009_2018_CO_IES_by_ANO_TP_COR_RACA_TP_SEXO.csv",",",escape_double = FALSE,trim_ws = FALSE)
#CENSO_SUP$TP_SEXO <- ifelse(CENSO_SUP$TP_SEXO==1,"Feminino","Feminino")
CENSO_SUP$TP_SEXO <- ifelse(CENSO_SUP$TP_SEXO==1,"F","F")

# Transformacao da variavel numerica de acordo com o vocabulario 
CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==0,"*NQD",
                                CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==1,"Branca",CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==2,"Preta",CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==3,"Parda",CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==4,"Amarela",CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==5,"Indígena",CENSO_SUP$TP_COR_RACA <- ifelse(CENSO_SUP$TP_COR_RACA==9,"*NDI",NA)))))))

CONCLUINTES_SSA <- CENSO_SUP %>% filter(IN_CONCLUINTE==1)


```

O número de concluintes do sexo masculino (biológico - definição IBGE) 
desagregado por raça/cor (definição IBGE) está disponível no gráfico 
de barras.


Preta
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Preta** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Preta")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

Parda
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Parda** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Parda")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

Preta+Parda
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Preta+Parda** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Preta","Parda")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

Branca
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Branca** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Branca")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

Amarela
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Amarela** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Amarela")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

Indígena
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Indígena** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("Indígena")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

NQD
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Não Quis Definir** </font>


```{r,eval=TRUE}


CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("*NQD")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```

NDI
================================
### <font size="5"> **Nº de concluintes em ensino superior - Sexo Feminino e Raça/Cor - Não Definiu Identidade** </font>


```{r,eval=TRUE}

CONCLUINTES_SSA %>% 
	filter(TP_COR_RACA %in% c("*NDI")) %>%filter(TP_SEXO %in% c("F")) %>% 
	group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% 
	mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>%
   e_charts(x = ANO_CENSO_SUP) %>%
  e_bar(value, legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Não Definiu Identidade") %>% 
  #e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE)) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%
  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  )

```


Total
================================



```{r,eval=TRUE}

CONCLUINTES_SSA %>% filter(TP_SEXO %in% c("F")) %>% group_by(ANO_CENSO_SUP) %>% summarise(value =sum(value)) %>% mutate(ANO_CENSO_SUP=as.character(ANO_CENSO_SUP)) %>% 
#  mutate(value = format(value,scientific = TRUE)) %>%
  e_charts(x = ANO_CENSO_SUP) %>%   #,width = "100%", height = "200px") %>%
  e_bar(value,legend = FALSE, name = "Nº Concluintes") %>% 
  #e_labels(position = "right") %>% 
  e_labels(position = "top") %>% 
  e_tooltip() %>% 
  e_title("Sexo Feminino", "Total") %>% 
 # e_flip_coords() %>% 
  e_y_axis(splitLine = list(show = FALSE),formatter = e_axis_formatter("decimal", locale = "pt-br")) %>% 
  #e_x_axis(show = FALSE) %>%
  e_x_axis(show = TRUE) %>%
  e_color(
    c("#00c4cc", "#db4470"),
    "#ffffff"
  ) %>%  e_toolbox_feature(
    feature = "dataView",
    title = "Ver dados"
  ) %>% 
e_axis_labels(x ="",y= "") %>%
  e_tooltip(trigger="axis",
            axisPointer = list(
              type = "cross"),
            textStyle=list(fontFamily="arial",
                           fontSize=12)) %>%
  e_toolbox_feature(feature = "dataZoom") %>%  
  e_format_y_axis(suffix = "")


```

